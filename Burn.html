<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
    />
    <title>Dashboard - Brand</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="assets/fonts/fontawesome5-overrides.min.css" />
    <link rel="stylesheet" href="assets/bootstrap/css/index.css" />
  </head>
  <body id="page-top">
    <div id="wrapper">
      <nav
        class="navbar navbar-dark align-items-start sidebar sidebar-dark accordion bg-gradient-primary p-0"
      >
        <div class="container-fluid d-flex flex-column p-0">
          <a
            class="navbar-brand d-flex justify-content-center align-items-center sidebar-brand m-0"
            href="index.html"
            ><div class="sidebar-brand-icon rotate-n-15"></div>
            <div class="sidebar-brand-text mx-3">
              <span>Fincubator</span>
            </div></a
          >
          <hr class="sidebar-divider my-0" />
          <ul class="navbar-nav text-light" id="accordionSidebar">
            <li class="nav-item">
              <a class="nav-link active" href="KPI.html"
                ><i class="fas fa-tachometer-alt"></i><span  style="font-size: medium;">KPI's</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Burn.html"
                ><i class="fas fa-user"></i><span  style="font-size: medium;">Burn Rate Analysis</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Forecasting.html"
                ><i class="fas fa-table"></i
                ><span  style="font-size: medium;">Forecasting </span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="BreakEven.html"
                ><i class="far fa-user-circle"></i
                ><span  style="font-size: medium;">Break even Analysis</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Capital.html"
                ><i class="far fa-user-circle"></i
                ><span  style="font-size: medium;">Captial Structure Analysis</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Home.html"
                ><i class="far fa-user-circle"></i><span  style="font-size: medium;">Home</span></a
              >
            </li>
          </ul>
          <div class="text-center d-none d-md-inline">
            <button
              class="btn rounded-circle border-0"
              id="sidebarToggle"
              type="button"
            ></button>
          </div>
        </div>
      </nav>
      <div class="d-flex flex-column" id="content-wrapper">
        <div id="content">
          <nav
            class="navbar navbar-light navbar-expand bg-white shadow mb-4 topbar static-top"
          >
            <div class="container-fluid">
              <button
                class="btn btn-link d-md-none rounded-circle me-3"
                id="sidebarToggleTop"
                type="button"
              >
                <i class="fas fa-bars"></i>
              </button>
              <form
                class="d-none d-sm-inline-block me-auto ms-md-3 my-2 my-md-0 mw-100 navbar-search"
              ></form>
            </div>
          </nav>

          <div class="ms-4 mb-2">
            <div class="pl-5 pb-1 text-gray-600">
              <h4>What is Burn rate?</h4>
            </div>
            <div class="mb-2 text-gray-600">
              <p>
                Burn rate analysis is the process of measuring and analyzing how
                quickly a company is spending its available funds. It helps
                determine how long a company can sustain its operations before
                running out of cash.
              </p>
            </div>
            <div class="pl-5 pb-2 text-gray-600">
              <h4>Example</h4>
            </div>
            <div class="text-gray-600 pb-3">
              <p>
                An example of burn rate analysis is a startup company
                determining that it is spending $50,000 per month while having
                $500,000 in available funds. Based on this burn rate, the
                company can estimate that it has a runway of 10 months before it
                runs out of cash.
              </p>
            </div>
          </div>
          <div class="container">
            <div class="ms-4">
              <div class="row">
                <div class="col mb-4">
                  <div class="card shadow border-start-info py-2">
                    <div class="card-body">
                      <div class="row align-items-center no-gutters">
                        <div class="col me-2">
                          <div
                            class="text-uppercase text-success fw-bold text-s mb-1"
                          >
                            <span>Cash Inflow</span>
                          </div>
                          <div class="row g-0 align-items-center">
                            <div class="col-auto">
                              <div class="text-dark fw-bold h5 mb-0 me-3">
                                <span id="inflow">0</span>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-auto">
                          <i
                            class="fas fa-clipboard-list fa-2x text-gray-300"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col mb-4">
                  <div class="card shadow border-start-info py-2">
                    <div class="card-body">
                      <div class="row align-items-center no-gutters">
                        <div class="col me-2">
                          <div
                            class="text-uppercase text-primary fw-bold text-s mb-1"
                          >
                            <span>Cash Outflow</span>
                          </div>
                          <div class="row g-0 align-items-center">
                            <div class="col-auto">
                              <div class="text-dark fw-bold h5 mb-0 me-3">
                                <span id="outflow">0</span>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-auto">
                          <i
                            class="fas fa-clipboard-list fa-2x text-gray-300"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="ms-4 mb-5">
              <div class="row justify-content-center">
                <div class="col-xl-6 mb-4">
                  <div class="card shadow border-start-info py-2">
                    <div class="card-body">
                      <div class="row align-items-center no-gutters">
                        <div class="col me-2">
                          <div
                            class="text-uppercase text-danger fw-bold text-s mb-1"
                          >
                            <span>Runway</span>
                          </div>
                          <div class="row g-0 align-items-center">
                            <div class="col-auto">
                              <div class="text-dark fw-bold h5 mb-0 me-3">
                                <span id="runway">0</span>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-auto">
                          <i
                            class="fas fa-clipboard-list fa-2x text-gray-300"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="ms-5">
              <div style="height: 600px; width: 900px">
                <canvas id="myChart"></canvas>
              </div>
            </div>
            <div class="m-3">
              <button id="openModalBtn" class="btn btn-primary">
                Update Data
              </button>
            </div>

            <div id="modal" class="modal">
              <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Update Data</h2>
                <form id="numberForm">
                  <div class="form-group">
                    <label for="salaries">Salaries</label>
                    <input
                      type="number"
                      id="salaries"
                      placeholder="Salaries Per Month"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label for="misc">Miscellaneous</label>
                    <input
                      type="number"
                      id="misc"
                      placeholder="Miscellaneous Per Month"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label for="marketing">Marketing</label>
                    <input
                      type="number"
                      id="marketing"
                      placeholder="Marketing expenses Per Month"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label for="operations">Operations</label>
                    <input
                      type="number"
                      id="operations"
                      placeholder="Operations Per Month"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label for="cogs">COGS</label>
                    <input
                      type="number"
                      id="cogs"
                      placeholder="COGS Per Month"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label for="investment">Investment</label>
                    <input
                      type="number"
                      id="investment"
                      placeholder="Investment Per Month"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label for="bootstrap">Bootstrap</label>
                    <input
                      type="number"
                      id="bootstrap"
                      placeholder="Bootstrap Per Month"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label for="revenue">Revenue</label>
                    <input
                      type="number"
                      id="revenue"
                      placeholder="Revenue Per Month"
                      required
                    />
                  </div>
                  <button
                    type="submit"
                    id="saveBtn"
                    class="btn btn-primary"
                    onclick="updateData()"
                  >
                    Save
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Get the modal element
      const modal = document.getElementById("modal");
      // Get the button that opens the modal
      const openModalBtn = document.getElementById("openModalBtn");
      // Get the <span> element that closes the modal
      const closeBtn = document.getElementsByClassName("close")[0];
      // Get the save button inside the modal
      const saveBtn = document.getElementById("saveBtn");

      // Open the modal when the button is clicked
      openModalBtn.addEventListener("click", function () {
        modal.style.display = "block";
      });

      // Close the modal when the close button is clicked
      closeBtn.addEventListener("click", function () {
        modal.style.display = "none";
      });

      // Save the numbers when the save button is clicked
      function updateData() {
        const salaries = document.getElementById("salaries").value;
        const misc = document.getElementById("misc").value;
        const marketing = document.getElementById("marketing").value;
        const operations = document.getElementById("operations").value;
        const cogs = document.getElementById("cogs").value;
        const investment = document.getElementById("investment").value;
        const bootstrap = document.getElementById("bootstrap").value;
        const revenue = document.getElementById("revenue").value;

        console.log(salaries);
        console.log(misc);
        console.log(marketing);
        console.log(operations);
        console.log(cogs);
        console.log(investment);
        console.log(bootstrap);
        console.log(revenue);

        const data = fetch("http://127.0.0.1:5000/burn_rate/create", {
          method: "POST",
          headers: {
            "Content-Type": "application/json; charset=UTF-8",
          },
          body: JSON.stringify({
            email: "bhavyam@gmail.com",
            salaries: salaries,
            miscellaneous: misc,
            marketing: marketing,
            operation: operations,
            cogs: cogs,
            investment: investment,
            bootstrap: bootstrap,
            revenue: revenue,
          }),
        })
          .then((res) => res.json())
          .then((data) => {
            console.log(data);
          });
      }

      modal.style.display = "none"; // Close the modal after saving
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      // class the api http://127.0.0.1:5000/burn_rate/get with body {'mail' : email}
      // get the data from the api
      const inflow = document.getElementById("inflow");
      const outflow = document.getElementById("outflow");
      const runway = document.getElementById("runway");

      const data = fetch("http://127.0.0.1:5000/burn_rate/get", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ mail: "bhavyam@gmail.com" }),
      })
        .then((res) => res.json())
        .then((data) => {
          console.log(data);
          inflow.innerHTML = data[0]["inflow"];
          outflow.innerHTML = data[0]["outflow"];
          runway.innerHTML = data[0]["time_in_months"];
          // make global variable for array

          const array = data[0]["array"];
          const labels = data[0]["labels"];

          // make a chart
          const ctx = document.getElementById("myChart");
          const sum = array.reduce((total, value) => total + value, 0);
          const percentages = array.map((value) =>
            ((value / sum) * 100).toFixed(2)
          );
          new Chart(ctx, {
            type: "pie",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "Percentage value",
                  data: percentages,
                  backgroundColor: [
                    "rgb(255, 99, 132)",
                    "rgb(54, 162, 235)",
                    "rgb(255, 205, 86)",
                    "rgb(125, 99, 132)",
                    "rgb(64, 162, 235)",
                    "rgb(32, 205, 86)",
                    "rgb(255, 56, 132)",
                    "rgb(122, 162, 235)",
                    "rgb(255, 205, 0)",
                  ],
                  hoverOffset: 4,
                },
              ],
            },
            options: {
              scales: {
                y: {
                  beginAtZero: true,
                },
              },
            },
          });
          // ending
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
    <script src="assets/js/script.min.js"></script>
  </body>
</html>
