<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
    />
    <title>Dashboard - Brand</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="assets/fonts/fontawesome5-overrides.min.css" />
    <link rel="stylesheet" href="assets/bootstrap/css/index.css" />
  </head>
  <body id="page-top">
    <div id="wrapper">
      <nav
        class="navbar navbar-dark align-items-start sidebar sidebar-dark accordion bg-gradient-primary p-0"
      >
        <div class="container-fluid d-flex flex-column p-0">
          <a
            class="navbar-brand d-flex justify-content-center align-items-center sidebar-brand m-0"
            href="index.html"
            ><div class="sidebar-brand-icon rotate-n-15"></div>
            <div class="sidebar-brand-text mx-3">
              <span>Fincubator</span>
            </div></a
          >
          <hr class="sidebar-divider my-0" />
          <ul class="navbar-nav text-light" id="accordionSidebar">
            <li class="nav-item">
              <a class="nav-link active" href="KPI.html"
                ><i class="fas fa-tachometer-alt"></i><span>KPI's</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Burn.html"
                ><i class="fas fa-user"></i><span>Burn Rate Analysis</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Forecasting.html"
                ><i class="fas fa-table"></i
                ><span>Forecasting and Projections</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="BreakEven.html"
                ><i class="far fa-user-circle"></i
                ><span>Break even Analysis</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Capital.html"
                ><i class="far fa-user-circle"></i
                ><span>Captial Structure Analysis</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Home.html"
                ><i class="far fa-user-circle"></i><span>Home</span></a
              >
            </li>
          </ul>
          <div class="text-center d-none d-md-inline">
            <button
              class="btn rounded-circle border-0"
              id="sidebarToggle"
              type="button"
            ></button>
          </div>
        </div>
      </nav>
      <div class="d-flex flex-column" id="content-wrapper">
        <div id="content">
          <nav
            class="navbar navbar-light navbar-expand bg-white shadow mb-4 topbar static-top"
          >
            <div class="container-fluid">
              <button
                class="btn btn-link d-md-none rounded-circle me-3"
                id="sidebarToggleTop"
                type="button"
              >
                <i class="fas fa-bars"></i>
              </button>
              <form
                class="d-none d-sm-inline-block me-auto ms-md-3 my-2 my-md-0 mw-100 navbar-search"
              ></form>
            </div>
          </nav>

          <div class="container">
            <div class="ps-4">
              <div class="row">
                <div class="col mb-4">
                  <div class="card shadow border-start-info py-2">
                    <div class="card-body">
                      <div class="row align-items-center no-gutters">
                        <div class="col me-2">
                          <div
                            class="text-uppercase text-success fw-bold text-s mb-1"
                          >
                            <span>Customer Accquisation Cost</span>
                          </div>
                          <div class="row g-0 align-items-center">
                            <div class="col-auto">
                              <div class="text-dark fw-bold h5 mb-0 me-3">
                                <span id="CAC">0</span>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-auto">
                          <i
                            class="fas fa-clipboard-list fa-2x text-gray-300"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col mb-4">
                  <div class="card shadow border-start-warning py-2">
                    <div class="card-body">
                      <div class="row align-items-center no-gutters">
                        <div class="col me-2">
                          <div
                            class="text-uppercase text-warning fw-bold text-s mb-1"
                          >
                            <span>Customer Lifetime Value</span>
                          </div>
                          <div class="row g-0 align-items-center">
                            <div class="col-auto">
                              <div class="text-dark fw-bold h5 mb-0 me-3">
                                <span id="CLV">0</span>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-auto">
                          <i
                            class="fas fa-clipboard-list fa-2x text-gray-300"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col mb-4">
                  <div class="card shadow border-start-success py-2">
                    <div class="card-body">
                      <div class="row align-items-center no-gutters">
                        <div class="col me-2">
                          <div
                            class="text-uppercase text-info fw-bold text-s mb-1"
                          >
                            <span>Gross Margin</span>
                          </div>
                          <div class="row g-0 align-items-center">
                            <div class="col-auto">
                              <div class="text-dark fw-bold h5 mb-0 me-3">
                                <span id="gross_margin">0</span>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-auto">
                          <i
                            class="fas fa-clipboard-list fa-2x text-gray-300"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="ps-4">
              <div class="row">
                <div class="col mb-4">
                  <div class="card shadow border-start-primary py-2">
                    <div class="card-body">
                      <div class="row align-items-center no-gutters">
                        <div class="col me-2">
                          <div
                            class="text-uppercase text-danger fw-bold text-s mb-1"
                          >
                            <span>Churn Rate</span>
                          </div>
                          <div class="row g-0 align-items-center">
                            <div class="col-auto">
                              <div class="text-dark fw-bold h5 mb-0 me-3">
                                <span id="churn">0</span>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-auto">
                          <i
                            class="fas fa-clipboard-list fa-2x text-gray-300"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col mb-4">
                  <div class="card shadow border-start-info py-2">
                    <div class="card-body">
                      <div class="row align-items-center no-gutters">
                        <div class="col me-2">
                          <div
                            class="text-uppercase text-info fw-bold text-s mb-1"
                          >
                            <span>User Retention</span>
                          </div>
                          <div class="row g-0 align-items-center">
                            <div class="col-auto">
                              <div class="text-dark fw-bold h5 mb-0 me-3">
                                <span id="retention">0</span>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-auto">
                          <i
                            class="fas fa-clipboard-list fa-2x text-gray-300"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col mb-4">
                  <div class="card shadow border-start-info py-2">
                    <div class="card-body">
                      <div class="row align-items-center no-gutters">
                        <div class="col me-2">
                          <div
                            class="text-uppercase text-primary fw-bold text-s mb-1"
                          >
                            <span>Monthly Active Users</span>
                          </div>
                          <div class="row g-0 align-items-center">
                            <div class="col-auto">
                              <div class="text-dark fw-bold h5 mb-0 me-3">
                                <span>NA</span>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-auto">
                          <i
                            class="fas fa-clipboard-list fa-2x text-gray-300"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <script>
            const CAC = document.getElementById("CAC");
            const CLV = document.getElementById("CLV");
            const gross_margin = document.getElementById("gross_margin");
            const churn = document.getElementById("churn");
            const retention = document.getElementById("retention");

            // call the api http://127.0.0.1:5000/kpi_table/getall with the method post with the body as {'mail':mail} and get the response as json and store it in the variable data
            const data = fetch("http://127.0.0.1:5000/kpi_table/getall", {
              method: "POST",
              body: JSON.stringify({ mail: "bhavyam@gmail.com" }),
              headers: {
                "Content-type": "application/json; charset=UTF-8",
              },
            })
              .then((response) => response.json())
              .then((json) => {
                console.log(json);
                CAC.innerHTML = json[0]["cac"];
                CLV.innerHTML = json[0]["clv"];
                // convert gross margin to float and then to percentage
                gross_margin.innerHTML = json[0]["gross_margin"];

                churn.innerHTML = json[0]["churn_rate"];
                retention.innerHTML = "NA"; //json[0]["retention"];
              });
          </script>

          <div class="ms-3 text-gray-600 text-s">
            <h4>Customer Accquisation Cost</h4>
            <p>
              It is a business metric that calculates the cost a company incurs
              to acquire a new customer. It includes the expenses associated
              with marketing and sales efforts aimed at acquiring customers,
              such as advertising costs, sales team salaries, marketing
              campaigns, and other related expenses.
            </p>
            <h4>Customer Lifetime Value</h4>
            <p>
              Customer Lifetime Value (CLV) is a metric that predicts the net
              profit a business expects to generate from a customer throughout
              their entire relationship. It helps businesses understand the
              long-term value of a customer and guides decisions related to
              customer acquisition, retention, and marketing strategies.
            </p>
            <h4>Gross Margin</h4>
            <p>
              Gross Margin is a financial metric that represents the difference
              between a company's revenue and the direct costs associated with
              producing or delivering the goods or services sold. It reflects
              the profitability of a company's core operations before
              considering other expenses such as overhead costs or taxes. Gross
              Margin is calculated by subtracting the cost of goods sold (COGS)
              from the total revenue and is usually expressed as a percentage.
              It provides insights into the efficiency of a company's production
              or service delivery processes and is an important indicator of
              profitability.
            </p>
            <h4>Churn Rate</h4>
            <p>
              Churn rate measures customer attrition, representing the
              percentage of customers who stop doing business with a company.
              High churn rates can impact revenue and growth, necessitating
              strategies to improve customer retention.
            </p>
            <h4>User Retention</h4>
            <p>
              User retention refers to the ability of a company to retain its
              customers or users over a period of time. It is a measure of how
              successful a business is in keeping its existing customers engaged
              and satisfied with its products or services. High user retention
              indicates customer loyalty and can contribute to long-term
              business success.
            </p>
            <h4>Monthly Active Users</h4>
            <p>
              Monthly Active Users (MAU) measures the number of unique users who
              engage with a product or platform within a month, indicating user
              activity and popularity.
            </p>
          </div>
        </div>

        <div class="m-3">
          <button id="openModalBtn" class="btn btn-primary">Update Data</button>
        </div>

        <div id="modal" class="modal">
          <div class="modal-content">
            <span class="close">&times;</span>
            <h4>Enter Details</h4>
            <form id="numberForm">
              <div class="form-group">
                <label for="total_sales_marketing"
                  >Total Sale and Marketing</label
                >
                <input
                  type="number"
                  id="total_sales_marketing"
                  placeholder="Sale"
                  required
                />
              </div>
              <div class="form-group">
                <label for="total_revenue">Total Revenue</label>
                <input
                  type="number"
                  id="total_revenue"
                  placeholder="Revenue"
                  required
                />
              </div>
              <div class="form-group">
                <label for="total_customers">Total Customers</label>
                <input
                  type="number"
                  id="total_customers"
                  placeholder="Total Customers"
                  required
                />
              </div>
              <div class="form-group">
                <label for="users_lost">Users Lost</label>
                <input
                  type="number"
                  id="users_lost"
                  placeholder="User lost"
                  required
                />
              </div>
              <div class="form-group">
                <label for="cogs">Cost of Goods&Services</label>
                <input type="number" id="cogs" placeholder="Cogs" required />
              </div>

              <button type="submit" id="saveBtn" class="btn btn-primary">
                Save
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      const ctx = document.getElementById("myChart");
      new Chart(ctx, {
        type: "line",
        data: {
          labels: ["a", "b", "c", "d", "e", "f", "g"],
          datasets: [
            {
              label: "Percentage value",
              data: [65, 59, 80, 81, 56, 55, 40],
            },
          ],
        },
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
    <script src="assets/js/script.min.js"></script>

    <script>
      $(document).ready(function () {
        // Show the modal when the button is clicked
        $("button").click(function () {
          $("#myModal").modal();
        });
      });
    </script>
    <script>
      // Get the modal element
      const modal = document.getElementById("modal");
      // Get the button that opens the modal
      const openModalBtn = document.getElementById("openModalBtn");
      // Get the <span> element that closes the modal
      const closeBtn = document.getElementsByClassName("close")[0];
      // Get the save button inside the modal
      const saveBtn = document.getElementById("saveBtn");

      // Open the modal when the button is clicked
      openModalBtn.addEventListener("click", function () {
        modal.style.display = "block";
      });

      // Close the modal when the close button is clicked
      closeBtn.addEventListener("click", function () {
        modal.style.display = "none";
      });

      // Save the numbers when the save button is clicked
      saveBtn.addEventListener("click", function () {
        const total_sales_marketing = document.getElementById(
          "total_sales_marketing"
        ).value;
        const total_revenue = document.getElementById("total_revenue").value;
        const total_customers =
          document.getElementById("total_customers").value;
        const users_lost = document.getElementById("users_lost").value;
        const cogs = document.getElementById("cogs").value;

        // create a json object with the numbers and post it to http://127.0.0.1:5000/kpi_table/create

        const data = fetch("http:///127.0.0.1:5000/kpi_table/create", {
          method: "POST",
          body: JSON.stringify({
            email: "bhavyam@gmail.com",
            total_sale_and_marketing: total_sales_marketing,
            total_revenue: total_revenue,
            total_cust: total_customers,
            user_stopped: users_lost,
            cogs: cogs,
          }),
          headers: {
            "Content-type": "application/json; charset=UTF-8",
          },
        });

        console.log(
          total_sales_marketing,
          total_revenue,
          total_customers,
          users_lost,
          cogs
        );

        // You can store the numbers in variables or perform any other actions here

        modal.style.display = "none"; // Close the modal after saving
      });
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"
      integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
